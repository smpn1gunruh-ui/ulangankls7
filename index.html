<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ulangan Informatika Kelas 7</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .timer-warning {
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
    </style>
</head>
<body class="min-h-full bg-gradient-to-br from-blue-50 to-indigo-100">
    <div class="min-h-full flex items-center justify-center p-4">
        <div class="w-full max-w-4xl">
            <!-- Header -->
            <header class="text-center mb-8">
                <h1 class="text-4xl font-bold text-indigo-800 mb-2">üìö Ulangan Informatika</h1>
                <p class="text-lg text-gray-600">Kelas 7 - Semester 1</p>
            </header>

            <!-- Form Input Siswa -->
            <div id="studentForm" class="bg-white rounded-xl shadow-lg p-8 mb-6 fade-in">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6 text-center">Data Siswa</h2>
                <form class="space-y-6">
                    <div>
                        <label for="studentName" class="block text-sm font-medium text-gray-700 mb-2">Nama Lengkap</label>
                        <input type="text" id="studentName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Masukkan nama lengkap" required>
                    </div>
                    <div>
                        <label for="studentClass" class="block text-sm font-medium text-gray-700 mb-2">Kelas</label>
                        <select id="studentClass" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required>
                            <option value="">Pilih Kelas</option>
                            <option value="7.1">7.1</option>
                            <option value="7.2">7.2</option>
                            <option value="7.3">7.3</option>
                            <option value="7.4">7.4</option>
                            <option value="7.5">7.5</option>
                            <option value="7.6">7.6</option>
                            <option value="7.7">7.7</option>
                        </select>
                    </div>
                    <button type="submit" class="w-full bg-indigo-600 text-white py-3 px-6 rounded-lg hover:bg-indigo-700 transition duration-200 font-semibold">
                        Mulai Ulangan üöÄ
                    </button>
                </form>
            </div>

            <!-- Quiz Container -->
            <div id="quizContainer" class="hidden">
                <!-- Timer dan Progress -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <div class="flex items-center space-x-4">
                            <div id="timer" class="text-2xl font-bold text-red-600">‚è∞ 30:00</div>
                            <div class="text-sm text-gray-600">
                                <span id="currentQuestion">1</span> dari <span id="totalQuestions">20</span>
                            </div>
                        </div>
                        <div class="text-sm text-gray-600">
                            <span id="studentInfo"></span>
                        </div>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="progressBar" class="bg-indigo-600 h-2 rounded-full transition-all duration-300" style="width: 5%"></div>
                    </div>
                </div>

                <!-- Question Card -->
                <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
                    <div class="mb-6">
                        <span id="chapterBadge" class="inline-block bg-indigo-100 text-indigo-800 text-sm font-medium px-3 py-1 rounded-full mb-4">Bab 1</span>
                        <h3 id="questionText" class="text-xl font-semibold text-gray-800 mb-6"></h3>
                    </div>
                    
                    <div id="optionsContainer" class="space-y-3">
                        <!-- Options will be inserted here -->
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button id="prevBtn" class="px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200 disabled:opacity-50" disabled>
                            ‚Üê Sebelumnya
                        </button>
                        <button id="nextBtn" class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition duration-200">
                            Selanjutnya ‚Üí
                        </button>
                    </div>
                </div>
            </div>

            <!-- Results -->
            <div id="resultsContainer" class="hidden bg-white rounded-xl shadow-lg p-8 text-center">
                <div class="mb-6">
                    <div id="scoreIcon" class="text-6xl mb-4">üéâ</div>
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Ulangan Selesai!</h2>
                    <div id="finalScore" class="text-2xl font-semibold text-indigo-600 mb-4"></div>
                    <div id="resultDetails" class="text-gray-600 space-y-2"></div>
                </div>
                
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                    <p class="text-green-800">‚úÖ Hasil telah disimpan ke spreadsheet</p>
                </div>
                
                <button onclick="restartQuiz()" class="bg-indigo-600 text-white py-3 px-8 rounded-lg hover:bg-indigo-700 transition duration-200 font-semibold">
                    Ulang Lagi
                </button>
            </div>
        </div>
    </div>

    <script>
        // Bank soal per bab
        const questionBank = {
            1: [ // Bab 1: Pengenalan Informatika
                {
                    question: "Apa yang dimaksud dengan informatika?",
                    options: ["Ilmu tentang komputer saja", "Ilmu tentang pengolahan informasi", "Ilmu tentang internet", "Ilmu tentang game"],
                    correct: 1
                },
                {
                    question: "Manakah yang termasuk perangkat keras komputer?",
                    options: ["Microsoft Word", "Processor", "Windows", "Google Chrome"],
                    correct: 1
                },
                {
                    question: "Apa fungsi utama dari sistem operasi?",
                    options: ["Membuat dokumen", "Mengelola sumber daya komputer", "Browsing internet", "Bermain game"],
                    correct: 1
                },
                {
                    question: "Manakah yang merupakan contoh perangkat input?",
                    options: ["Monitor", "Speaker", "Keyboard", "Printer"],
                    correct: 2
                },
                {
                    question: "Apa kepanjangan dari CPU?",
                    options: ["Computer Processing Unit", "Central Processing Unit", "Central Program Unit", "Computer Program Unit"],
                    correct: 1
                }
            ],
            2: [ // Bab 2: Berpikir Komputasional
                {
                    question: "Apa yang dimaksud dengan algoritma?",
                    options: ["Program komputer", "Langkah-langkah sistematis untuk menyelesaikan masalah", "Bahasa pemrograman", "Perangkat keras"],
                    correct: 1
                },
                {
                    question: "Manakah yang merupakan contoh decomposition dalam berpikir komputasional?",
                    options: ["Membuat program", "Memecah masalah besar menjadi bagian kecil", "Menghafal kode", "Membeli komputer"],
                    correct: 1
                },
                {
                    question: "Apa yang dimaksud dengan pattern recognition?",
                    options: ["Mengenali pola atau kesamaan", "Membuat pola baru", "Menghapus pola", "Mengubah pola"],
                    correct: 0
                },
                {
                    question: "Abstraction dalam berpikir komputasional berarti?",
                    options: ["Membuat sesuatu menjadi rumit", "Menyederhanakan dengan fokus pada hal penting", "Menghapus semua detail", "Membuat abstrak seni"],
                    correct: 1
                },
                {
                    question: "Manakah urutan yang benar dalam membuat algoritma?",
                    options: ["Langsung coding", "Analisis - Desain - Implementasi - Testing", "Testing - Coding", "Desain - Analisis"],
                    correct: 1
                }
            ],
            3: [ // Bab 3: Teknologi Informasi dan Komunikasi
                {
                    question: "Apa kepanjangan dari TIK?",
                    options: ["Teknologi Informasi Komputer", "Teknologi Informasi dan Komunikasi", "Teknik Informasi Komunikasi", "Teknologi Internet Komunikasi"],
                    correct: 1
                },
                {
                    question: "Manakah yang termasuk media komunikasi digital?",
                    options: ["Surat pos", "Email", "Telepon rumah", "Fax"],
                    correct: 1
                },
                {
                    question: "Apa fungsi utama dari internet?",
                    options: ["Hanya untuk bermain game", "Menghubungkan komputer di seluruh dunia", "Hanya untuk menonton video", "Hanya untuk berbelanja"],
                    correct: 1
                },
                {
                    question: "Manakah yang merupakan contoh aplikasi produktivitas?",
                    options: ["Game online", "Microsoft Office", "Media sosial", "Video streaming"],
                    correct: 1
                },
                {
                    question: "Apa yang dimaksud dengan cloud computing?",
                    options: ["Komputer di awan", "Layanan komputasi melalui internet", "Komputer yang rusak", "Software bajakan"],
                    correct: 1
                }
            ],
            4: [ // Bab 4: Sistem Komputer
                {
                    question: "Apa yang dimaksud dengan hardware?",
                    options: ["Perangkat lunak", "Perangkat keras komputer", "Data", "Jaringan"],
                    correct: 1
                },
                {
                    question: "Manakah yang termasuk perangkat output?",
                    options: ["Mouse", "Keyboard", "Monitor", "Microphone"],
                    correct: 2
                },
                {
                    question: "Apa fungsi dari RAM?",
                    options: ["Menyimpan data permanen", "Menyimpan data sementara saat komputer bekerja", "Menampilkan gambar", "Memutar suara"],
                    correct: 1
                },
                {
                    question: "Manakah yang merupakan perangkat penyimpanan?",
                    options: ["Processor", "Hard disk", "RAM", "Motherboard"],
                    correct: 1
                },
                {
                    question: "Apa perbedaan antara hardware dan software?",
                    options: ["Tidak ada perbedaan", "Hardware bisa disentuh, software tidak", "Software lebih mahal", "Hardware selalu rusak"],
                    correct: 1
                }
            ],
            5: [ // Bab 5: Jaringan Komputer dan Internet
                {
                    question: "Apa yang dimaksud dengan jaringan komputer?",
                    options: ["Satu komputer saja", "Kumpulan komputer yang terhubung", "Software antivirus", "Game online"],
                    correct: 1
                },
                {
                    question: "Manakah yang merupakan jenis jaringan berdasarkan area?",
                    options: ["LAN, MAN, WAN", "TCP, IP, HTTP", "Windows, Linux, Mac", "Word, Excel, PowerPoint"],
                    correct: 0
                },
                {
                    question: "Apa kepanjangan dari WWW?",
                    options: ["World Wide Web", "World Wide Window", "World Web Window", "Wide World Web"],
                    correct: 0
                },
                {
                    question: "Protokol apa yang digunakan untuk browsing web?",
                    options: ["FTP", "HTTP", "SMTP", "POP3"],
                    correct: 1
                },
                {
                    question: "Apa fungsi dari browser?",
                    options: ["Membuat website", "Mengakses dan menampilkan halaman web", "Mengirim email", "Bermain game"],
                    correct: 1
                }
            ]
        };

        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let answers = [];
        let timeLeft = 1800; // 30 menit
        let timerInterval;
        let studentName = '';
        let studentClass = '';

        // Shuffle array function
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // Generate random questions
        function generateQuestions() {
            currentQuestions = [];
            
            // Ambil 4 soal dari setiap bab (total 20 soal)
            for (let bab = 1; bab <= 5; bab++) {
                const babQuestions = shuffleArray(questionBank[bab]).slice(0, 4);
                babQuestions.forEach(q => {
                    currentQuestions.push({...q, chapter: bab});
                });
            }
            
            // Acak urutan soal
            currentQuestions = shuffleArray(currentQuestions);
            answers = new Array(currentQuestions.length).fill(null);
        }

        // Start timer
        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 300) { // 5 menit terakhir
                    document.getElementById('timer').classList.add('timer-warning');
                }
                
                if (timeLeft <= 0) {
                    finishQuiz();
                }
            }, 1000);
        }

        // Update timer display
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timer').textContent = `‚è∞ ${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        // Display question
        function displayQuestion() {
            const question = currentQuestions[currentQuestionIndex];
            
            document.getElementById('chapterBadge').textContent = `Bab ${question.chapter}`;
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('totalQuestions').textContent = currentQuestions.length;
            
            // Update progress bar
            const progress = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            
            // Display options
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition duration-200';
                optionDiv.onclick = () => selectOption(index);
                
                const isSelected = answers[currentQuestionIndex] === index;
                if (isSelected) {
                    optionDiv.classList.add('bg-indigo-50', 'border-indigo-300');
                }
                
                optionDiv.innerHTML = `
                    <input type="radio" name="option" value="${index}" ${isSelected ? 'checked' : ''} class="mr-3 text-indigo-600">
                    <label class="cursor-pointer flex-1">${String.fromCharCode(65 + index)}. ${option}</label>
                `;
                
                optionsContainer.appendChild(optionDiv);
            });
            
            // Update navigation buttons
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            document.getElementById('nextBtn').textContent = 
                currentQuestionIndex === currentQuestions.length - 1 ? 'Selesai' : 'Selanjutnya ‚Üí';
        }

        // Select option
        function selectOption(optionIndex) {
            answers[currentQuestionIndex] = optionIndex;
            displayQuestion();
        }

        // Calculate score
        function calculateScore() {
            let correct = 0;
            currentQuestions.forEach((question, index) => {
                if (answers[index] === question.correct) {
                    correct++;
                }
            });
            return {
                correct: correct,
                total: currentQuestions.length,
                percentage: Math.round((correct / currentQuestions.length) * 100)
            };
        }

        // Save to spreadsheet (simulation)
        // Simpan ke spreadsheet lewat Google Apps Script
// Simpan ke spreadsheet lewat Google Apps Script
function saveToSpreadsheet(results) {
    const data = {
        name: studentName,
        class: studentClass,
        score: results.percentage, // Nilai (angka saja)
        correct: results.correct,  // Jumlah benar (angka)
        total: results.total,      // Jumlah soal (angka)
        timeUsed: Math.floor((1800 - timeLeft) / 60) // Waktu dalam menit (angka)
    };

    // Ganti URL di bawah ini dengan URL Web App milik kamu sendiri
    const scriptURL = "https://script.google.com/macros/s/AKfycbyUz7puV_9C0Xza25akC2MiK612wCbsy2RCZc4RgoGZ4Z3_-ig1VF-MHU214owJxZ_opg/exec";

    return fetch(scriptURL, {
        method: "POST",
        mode: "no-cors",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
    })
    .then(() => console.log("‚úÖ Data terkirim ke spreadsheet:", data))
    .catch((error) => console.error("‚ùå Gagal kirim:", error));
}

        // Finish quiz
        async function finishQuiz() {
            clearInterval(timerInterval);
            
            const results = calculateScore();
            
            // Hide quiz, show results
            document.getElementById('quizContainer').classList.add('hidden');
            document.getElementById('resultsContainer').classList.remove('hidden');
            
            // Display results
            const scoreIcon = results.percentage >= 80 ? 'üéâ' : results.percentage >= 60 ? 'üòä' : 'üòî';
            document.getElementById('scoreIcon').textContent = scoreIcon;
            document.getElementById('finalScore').textContent = `Nilai: ${results.percentage}`;
            
            const timeUsed = Math.floor((1800 - timeLeft) / 60);
            document.getElementById('resultDetails').innerHTML = `
                <p><strong>Nama:</strong> ${studentName}</p>
                <p><strong>Kelas:</strong> ${studentClass}</p>
                <p><strong>Benar:</strong> ${results.correct} dari ${results.total} soal</p>
                <p><strong>Waktu:</strong> ${timeUsed} menit</p>
            `;
            
            // Save to spreadsheet
            await saveToSpreadsheet(results);
        }

        // Restart quiz
        function restartQuiz() {
            // Reset all variables
            currentQuestionIndex = 0;
            timeLeft = 1800;
            answers = [];
            
            // Show form, hide results
            document.getElementById('resultsContainer').classList.add('hidden');
            document.getElementById('studentForm').classList.remove('hidden');
            
            // Clear form
            document.getElementById('studentName').value = '';
            document.getElementById('studentClass').value = '';
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Form submission
            document.querySelector('#studentForm form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                studentName = document.getElementById('studentName').value.trim();
                studentClass = document.getElementById('studentClass').value;
                
                if (!studentName || !studentClass) {
                    alert('Mohon lengkapi nama dan kelas!');
                    return;
                }
                
                // Hide form, show quiz
                document.getElementById('studentForm').classList.add('hidden');
                document.getElementById('quizContainer').classList.remove('hidden');
                
                // Set student info
                document.getElementById('studentInfo').textContent = `${studentName} - Kelas ${studentClass}`;
                
                // Generate questions and start
                generateQuestions();
                displayQuestion();
                startTimer();
            });
            
            // Navigation buttons
            document.getElementById('prevBtn').addEventListener('click', function() {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    displayQuestion();
                }
            });
            
            document.getElementById('nextBtn').addEventListener('click', function() {
                if (currentQuestionIndex < currentQuestions.length - 1) {
                    currentQuestionIndex++;
                    displayQuestion();
                } else {
                    // Finish quiz
                    finishQuiz();
                }
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'995665a9e2aa9cbd',t:'MTc2MTYxMjE4Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
