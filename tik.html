<!DOCTYPE html>
<html lang="id" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ulangan Informatika Kelas 7</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { box-sizing: border-box; }
    .fade-in { animation: fadeIn 0.5s ease-in; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .warning {
      background-color: #fde047 !important;
      color: #1f2937 !important;
      animation: pulse 1s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }
  </style>
</head>
<body class="h-full bg-gradient-to-br from-cyan-50 to-blue-100 font-sans">
  <div class="min-h-full flex flex-col">
    <header class="bg-white shadow-sm border-b-4 border-blue-500">
      <div class="max-w-4xl mx-auto px-6 py-4">
        <h1 class="text-2xl font-bold text-gray-800">üíª Ulangan Informatika Kelas 7</h1>
        <p class="text-gray-600 mt-1">Bab 1 ‚Äì 5 | Durasi 5 menit | 10 Soal</p>
      </div>
    </header>

    <main class="flex-1 max-w-4xl mx-auto px-6 py-8 w-full">
      <!-- Pilih Peran -->
      <div id="roleSelection" class="bg-white rounded-xl shadow-lg p-8 max-w-md mx-auto">
        <div class="text-center mb-6">
          <h2 class="text-xl font-semibold text-gray-800 mb-4">Pilih Peran Anda</h2>
          <p class="text-gray-600 text-sm">Silakan pilih sebagai siswa</p>
        </div>
        <button id="studentRoleBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-4 px-6 rounded-lg">üë®‚Äçüéì Masuk sebagai Siswa</button>
      </div>

      <!-- Form Login -->
      <div id="loginForm" class="hidden bg-white rounded-xl shadow-lg p-8 max-w-md mx-auto">
        <div class="text-center mb-6">
          <h2 class="text-xl font-semibold text-gray-800">Data Diri Siswa</h2>
        </div>
        <form id="studentForm" class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Nama Lengkap</label>
            <input type="text" id="studentName" required class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">NIP/NISN</label>
            <input type="text" id="studentNIP" required class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Kelas</label>
            <select id="studentClass" required class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500">
              <option value="">Pilih Kelas</option>
              <option value="7.1">7.1</option>
              <option value="7.2">7.2</option>
              <option value="7.3">7.3</option>
              <option value="7.4">7.4</option>
              <option value="7.5">7.5</option>
              <option value="7.6">7.6</option>
              <option value="7.7">7.7</option>
            </select>
          </div>
          <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg">Mulai Ulangan</button>
        </form>
      </div>

      <!-- Ulangan -->
      <div id="examInterface" class="hidden fade-in">
        <div class="bg-white rounded-lg shadow-sm p-4 mb-6 flex justify-between items-center">
          <div>
            <h3 class="font-semibold text-gray-800" id="displayName">-</h3>
            <p class="text-sm text-gray-600">NIP: <span id="displayNIP">-</span> | Kelas: <span id="displayClass">-</span></p>
          </div>
          <div class="text-right">
            <div class="text-lg font-bold text-blue-600" id="timer">05:00</div>
            <p class="text-xs text-gray-500">Waktu tersisa</p>
          </div>
        </div>

        <div class="bg-white rounded-xl shadow-lg p-8">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-semibold text-gray-800">Soal Ulangan Informatika</h2>
            <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium" id="questionCounter">1 / 10</span>
          </div>

          <div class="mb-8">
            <p class="text-lg text-gray-700 mb-6" id="questionText"></p>
            <div id="optionsContainer" class="space-y-3"></div>
          </div>

          <div class="flex justify-between">
            <button id="prevBtn" class="px-6 py-2 border rounded-lg text-gray-700 hover:bg-gray-50" disabled>‚Üê Sebelumnya</button>
            <button id="nextBtn" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg">Selanjutnya ‚Üí</button>
          </div>
        </div>
      </div>

      <!-- Hasil -->
      <div id="resultsScreen" class="hidden fade-in">
        <div class="bg-white rounded-xl shadow-lg p-8 max-w-2xl mx-auto text-center">
          <h2 class="text-2xl font-bold text-gray-800 mb-4">Ulangan Selesai!</h2>
          <div class="bg-gray-50 rounded-lg p-6 mb-6">
            <h3 class="font-semibold text-gray-800 mb-2" id="finalName">-</h3>
            <p class="text-gray-600 mb-4">NIP: <span id="finalNIP">-</span> | Kelas: <span id="finalClass">-</span></p>
            <div class="text-3xl font-bold text-blue-600 mb-2" id="finalScore">0</div>
            <p class="text-gray-600">dari 10 soal</p>
          </div>
          <button id="restartBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg">Ulangi</button>
        </div>
      </div>
    </main>
  </div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbydR9tkSdX7gEO1xDHVcBEmu8uks93S8nbYpYo2TcrXY0OR80fSr6_lSEiunz16u1I2og/exec"; // GANTI DENGAN URL SCRIPT KAMU

    // Soal Informatika (Bab 1‚Äì5)
    const originalQuestions = [
      { q: "Informatika adalah ilmu yang mempelajari tentang ...", o: ["A. Hewan dan tumbuhan","B. Komputer dan pengolahan informasi","C. Alam semesta","D. Ilmu sosial"], c: "B" },
      { q: "Perangkat keras komputer disebut juga dengan ...", o: ["A. Hardware","B. Software","C. Brainware","D. Firmware"], c: "A" },
      { q: "Contoh perangkat lunak pengolah kata adalah ...", o: ["A. Microsoft Word","B. Paint","C. Excel","D. Chrome"], c: "A" },
      { q: "Proses berpikir logis dan sistematis disebut ...", o: ["A. Komputasi","B. Algoritma","C. Simulasi","D. Analisis"], c: "B" },
      { q: "Satuan terkecil dari data digital adalah ...", o: ["A. Byte","B. Bit","C. Kilobyte","D. Megabyte"], c: "B" },
      { q: "Brainware adalah ...", o: ["A. Orang yang menggunakan komputer","B. Perangkat lunak komputer","C. Perangkat keras komputer","D. Sistem operasi"], c: "A" },
      { q: "Sistem operasi berfungsi untuk ...", o: ["A. Mengatur hubungan antara hardware dan software","B. Menghapus data","C. Membuat dokumen","D. Menggambar"], c: "A" },
      { q: "Langkah-langkah penyelesaian masalah dalam informatika disebut ...", o: ["A. Flowchart","B. Program","C. Algoritma","D. Diagram"], c: "C" },
      { q: "Internet merupakan jaringan ...", o: ["A. Lokal antar komputer","B. Global yang menghubungkan banyak komputer di dunia","C. Dua komputer saja","D. Tanpa kabel"], c: "B" },
      { q: "Contoh etika digital adalah ...", o: ["A. Menyebarkan hoax","B. Menghormati privasi orang lain","C. Membajak software","D. Mengambil data tanpa izin"], c: "B" }
    ];

    // Variabel global
    let questions = [];
    let current = 0;
    let answers = {};
    let timeLeft = 300;
    let timerInterval;
    let warned = false;
    let student = {};

    document.getElementById("studentRoleBtn").onclick = () => {
      roleSelection.classList.add("hidden");
      loginForm.classList.remove("hidden");
    };

    document.getElementById("studentForm").onsubmit = e => {
      e.preventDefault();
      student = {
        name: studentName.value,
        nip: studentNIP.value,
        class: studentClass.value
      };
      displayName.textContent = student.name;
      displayNIP.textContent = student.nip;
      displayClass.textContent = student.class;
      loginForm.classList.add("hidden");
      examInterface.classList.remove("hidden");
      questions = shuffle([...originalQuestions]);
      loadQuestion();
      startTimer();
    };

    function shuffle(arr) {
      return arr.sort(() => Math.random() - 0.5);
    }

    function loadQuestion() {
      const q = questions[current];
      questionText.textContent = q.q;
      questionCounter.textContent = `${current + 1} / ${questions.length}`;
      optionsContainer.innerHTML = "";
      q.o.forEach((opt, i) => {
        const letter = String.fromCharCode(65 + i);
        const checked = answers[current] === letter ? "checked" : "";
        optionsContainer.innerHTML += `
          <label class="flex items-center p-4 border rounded-lg hover:bg-gray-50">
            <input type="radio" name="answer" value="${letter}" class="mr-3" ${checked}>
            <span>${opt}</span>
          </label>`;
      });
      prevBtn.disabled = current === 0;
      nextBtn.textContent = current === questions.length - 1 ? "Selesai" : "Selanjutnya ‚Üí";
    }

    prevBtn.onclick = () => {
      saveAnswer();
      if (current > 0) current--;
      loadQuestion();
    };
    nextBtn.onclick = () => {
      saveAnswer();
      if (current < questions.length - 1) current++;
      else finishExam();
      loadQuestion();
    };

    function saveAnswer() {
      const selected = document.querySelector('input[name="answer"]:checked');
      if (selected) answers[current] = selected.value;
    }

    function startTimer() {
      timerInterval = setInterval(() => {
        timeLeft--;
        const m = Math.floor(timeLeft / 60);
        const s = timeLeft % 60;
        timer.textContent = `${m.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`;

        // ‚è∞ Peringatan 30 detik terakhir
        if (timeLeft === 30 && !warned) {
          warned = true;
          timer.classList.add("warning");
          alert("‚ö†Ô∏è Waktu hampir habis! 30 detik tersisa.");
        }

        if (timeLeft <= 0) finishExam();
      }, 1000);
    }

    function finishExam() {
      clearInterval(timerInterval);
      let score = 0;
      questions.forEach((q, i) => {
        if (answers[i] === q.c) score++;
      });

      const result = {
        name: student.name,
        nip: student.nip,
        class: student.class,
        score: score,
        totalQuestions: questions.length,
        completedAt: new Date().toLocaleString("id-ID")
      };

      fetch(SCRIPT_URL, {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(result)
      });

      examInterface.classList.add("hidden");
      resultsScreen.classList.remove("hidden");
      finalName.textContent = student.name;
      finalNIP.textContent = student.nip;
      finalClass.textContent = student.class;
      finalScore.textContent = `${score}/${questions.length}`;
    }

    restartBtn.onclick = () => location.reload();
  </script>
</body>
</html>
